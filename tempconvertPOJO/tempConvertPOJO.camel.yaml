- route:
    id: route-ef4123
    from:
      id: from-ad5e3
      uri: cxf
      parameters:
        address: http://localhost:9999/hello
        dataFormat: MESSAGE
        loggingFeatureEnabled: false
        wsdlURL: https://www.w3schools.com/xml/tempconvert.asmx?wsdl
        serviceName: "{https://www.w3schools.com/xml/}TempConvert"
        portName: "{https://www.w3schools.com/xml/}TempConvertSoap"
      steps:
        - log:
            id: log-e4b323
            message: PALYLOAD=\n${body}
        - unmarshal:
            id: unmarshal-7ff73
            soap:
              id: soap-5e16
              contextPath: com.w3schools.xml
        - log:
            id: log-58d83
            message: UNMARSHALLED=\n${body}
        - choice:
            id: choice-e0a5
            when:
              - id: when-8d55
                description: C2F
                expression:
                  simple:
                    id: simple-99ec
                    expression: >
                      ${body.getClass().getName()} ==
                      'com.w3schools.xml.CelsiusToFahrenheit'
                steps:
                  - setBody:
                      id: setBody-4c0e3
                      expression:
                        java:
                          id: java-af123
                          expression: "int celsius = Integer.parseInt(((com.w3schools.xml.CelsiusToFahrenheit)body).getCelsius());\r\ncom.w3schools.xml.CelsiusToFahrenheitResponse response = new com.w3schools.xml.CelsiusToFahrenheitResponse();\r\nresponse.setCelsiusToFahrenheitResult(Integer.toString(32 + celsius * 9 / 5));\r\n\r\nreturn response;"
            otherwise:
              id: otherwise-f506
              description: F2C
              steps:
                - setBody:
                    id: setBody-0289
                    expression:
                      java:
                        id: java-8443
                        expression: >
                          int fahrenheit =
                          Integer.parseInt(((com.w3schools.xml.FahrenheitToCelsius)
                          body).getFahrenheit());

                          com.w3schools.xml.FahrenheitToCelsiusResponse response
                          = new com.w3schools.xml.FahrenheitToCelsiusResponse();

                          response.setFahrenheitToCelsiusResult(Integer.toString((fahrenheit
                          - 32) * 5 / 9));

                          return response;
        - marshal:
            id: marshal-65b43
            soap:
              id: soap-f28e
              contextPath: com.w3schools.xml
        - log:
            id: log-b3883
            message: RESPONSE=\n${body}
- route:
    id: route-146f
    nodePrefixId: route-bcc
    from:
      id: from-4f09
      description: starter
      uri: timer
      parameters:
        timerName: starter
        repeatCount: "1"
      steps:
        - setBody:
            id: setBody-eb39
            description: set soapbody
            expression:
              constant:
                id: constant-f217
                expression: >-
                  <?xml version="1.0" encoding="utf-8"?>

                  <soap:Envelope
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                  xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                    <soap:Body>
                      <FahrenheitToCelsius xmlns="https://www.w3schools.com/xml/">
                        <Fahrenheit>86</Fahrenheit>
                      </FahrenheitToCelsius>
                    </soap:Body>
                  </soap:Envelope>
        - log:
            id: log-5659
            description: body log
            message: ${body}
        - setHeaders:
            id: setHeaders-c0ed
            headers:
              - id: setHeader-d086
                description: Content-Type
                name: Content-Type
                expression:
                  constant:
                    id: constant-c6f5
                    expression: text/xml; charset=utf-8
        - to:
            id: to-ae4a
            description: Send to Server
            uri: cxf
            parameters:
              address: http://localhost:9999/hello
              wsdlURL: https://www.w3schools.com/xml/tempconvert.asmx?wsdl
              serviceName: "{https://www.w3schools.com/xml/}TempConvert"
              portName: "{https://www.w3schools.com/xml/}TempConvertSoap"
              dataFormat: RAW
        - log:
            id: log-4ca3
            description: log body answer
            message: ${body}
        - setBody:
            id: setBody-3bb3
            description: clean answer
            expression:
              xpath:
                id: xpath-6345
                expression: >-
                  /soap:Envelope/soap:Body/classic:CelsiusToFahrenheitResponse/classic:CelsiusToFahrenheitResult/text()
                  |
                  /soap:Envelope/soap:Body/classic:FahrenheitToCelsiusResponse/classic:FahrenheitToCelsiusResult/text()
                namespace:
                  - key: soap
                    value: http://schemas.xmlsoap.org/soap/envelope/
                  - key: classic
                    value: https://www.w3schools.com/xml/
                resultType: java.lang.String
        - log:
            id: log-21b6
            message: "Answer cleaned from server : ${body}"
            logName: log result value
